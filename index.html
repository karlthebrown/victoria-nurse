<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="Cache-Control" content="no-store, max-age=0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Victoria Nurse — Care Together</title>

  <!-- VERSION: bump to v10 to force refresh with SW v10 -->
  <script>window.__VN_VER__ = "2025-09-12-10";</script>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest?v=2025-09-12-10"/>
  <meta name="theme-color" content="#6366f1"/>

  <!-- Icons -->
  <link rel="icon" type="image/png" href="./icons/favicon.png?v=2025-09-12-10"/>
  <link rel="apple-touch-icon" href="./icons/icon-192.png?v=2025-09-12-10"/>
  <link rel="apple-touch-icon" sizes="180x180" href="./icons/icon-192.png?v=2025-09-12-10"/>
  <link rel="mask-icon" href="./icons/icon-192.png?v=2025-09-12-10" color="#6366f1"/>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet"/>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- PDF tools -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <style>
    :root{
      --vn-sky:#38bdf8;       /* ring + field text + label color */
      --vn-indigo:#6366f1;    /* brand header/footer */
      --vn-fuchsia:#d946ef;

      --vn-chip-hr:#ef38c0; --vn-chip-bp:#ffb703; --vn-chip-o2:#32e875; --vn-chip-rr:#38bdf8; --vn-chip-temp:#ff4d4d;
    }

    /* Labels: (3) brandy blue instead of black */
    label { color: var(--vn-sky); }

    /* Bigger, consistent inputs (2) */
    .vn-field{
      color: var(--vn-sky);
      padding: 0.95rem 1.1rem;
      border-radius: 0.9rem;
      border: 1px solid #cbd5e1;
      line-height: 1.6rem;
      background: #ffffff;
    }
    .vn-field:focus{
      outline: none;
      box-shadow: 0 0 0 2px var(--vn-sky);
      border-color: var(--vn-sky);
    }
    .vn-field::placeholder{
      color: #9fb6c8;
      opacity: 0.8;
    }
    /* Single-line inputs tall like textareas */
    .vn-input{ height: 3.5rem; }

    /* Tagline font */
    .vn-tagline{ font-family:"Playfair Display",ui-serif,Georgia,serif; letter-spacing:.2px; }

    /* PDF styles */
    .pdf-card{background:#000; color:#fff; width:794px; padding:28px;}
    .pdf-row{display:flex; align-items:center; gap:18px; margin:14px 0;}
    .pdf-lead{font-size:52px; font-weight:800; min-width:110px; text-align:right;}
    .pdf-chip{padding:8px 14px; border-radius:999px; font-weight:700; font-size:16px; color:#000;}
    .pdf-chip--unit{ background:#fff; color:#111827; }
    .pdf-wave{height:36px; width:120px; opacity:.9;}
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-sky-500 via-indigo-600 to-fuchsia-600 text-slate-900 antialiased">
  <div class="min-h-screen p-4 flex items-center justify-center">
    <main class="w-full max-w-3xl">
      <div class="bg-white/85 backdrop-blur-xl shadow-2xl rounded-3xl overflow-hidden ring-1 ring-white/40">
        <!-- Header -->
        <header class="bg-gradient-to-r from-indigo-600 to-sky-500 p-6">
          <div class="flex items-center gap-4">
            <!-- (1) Larger logo, no white tile -->
            <img src="./icons/icon-192.png?v=2025-09-12-10" alt="Victoria Nurse logo"
                 class="h-14 w-14 rounded-2xl shadow"
                 onerror="this.onerror=null;this.src='./icons/icon-192.png?v='+window.__VN_VER__;">
            <div>
              <h1 class="text-white text-2xl font-extrabold tracking-tight">Victoria Nurse</h1>
              <p class="vn-tagline text-white/95 text-sm">Care Together</p>
            </div>
          </div>
        </header>

        <!-- Form -->
        <section class="p-6 grid gap-6">
          <form id="formVitals" class="grid gap-6">
            <!-- Example field -->
            <div>
              <label for="patientName" class="block text-sm font-semibold mb-1">Patient Name</label>
              <input id="patientName" type="text" placeholder="Enter full name" class="vn-field vn-input w-full"/>
            </div>

            <!-- Other inputs (Temperature, Pulse, etc.) -->
            <!-- ... keep same pattern as above with class="vn-field vn-input w-full" -->

            <!-- Notes enlarged -->
            <div>
              <label for="notes" class="block text-sm font-semibold mb-1">Notes</label>
              <textarea id="notes" rows="8" placeholder="Observations, symptoms, instructions" class="vn-field w-full"></textarea>
            </div>

            <!-- Nurse Name -->
            <div>
              <label for="nurseName" class="block text-sm font-semibold mb-1">Nurse’s Name</label>
              <input id="nurseName" type="text" placeholder="Enter nurse's full name" class="vn-field vn-input w-full"/>
            </div>

            <!-- Buttons -->
            <div class="flex flex-col sm:flex-row gap-3">
              <button id="btnPreview" type="button" class="flex-1 px-4 py-3 rounded-xl font-semibold text-white bg-gradient-to-r from-indigo-600 via-sky-500 to-fuchsia-500">Preview & Generate PDF</button>
              <button id="btnWhatsApp" type="button" class="flex-1 px-4 py-3 rounded-xl font-semibold text-white bg-gradient-to-r from-indigo-600 via-sky-500 to-fuchsia-500">Share via WhatsApp</button>
              <button id="btnEmail" type="button" class="flex-1 px-4 py-3 rounded-xl font-semibold text-white bg-gradient-to-r from-indigo-600 via-sky-500 to-fuchsia-500">Share via Email (PDF)</button>
            </div>
          </form>
        </section>

        <!-- Footer -->
        <footer class="px-6 py-4 bg-white/70 text-sm flex items-center justify-between">
          <span class="font-medium" style="color:#6366f1">&copy; <span id="year"></span> Victoria Nurse</span>
          <span class="italic" style="color:#6366f1">Powered by: karlthebrown</span>
        </footer>
      </div>
    </main>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const ids = ['patientName','temperature','pulse','respiratoryRate','bloodPressure','oxygenSaturation','bloodSugar','pain','medMorning','medAfternoon','medEvening','notes','nurseName'];
    const g = id => document.getElementById(id);

    function getData(){ return Object.fromEntries(ids.map(k => [k, (g(k)?.value || '').trim()])); }

    function formatWhatsApp(d){
      return [
        '*Victoria Nurse — Care Together*','',
        '*Patient*: ' + (d.patientName || '-'),
        '*Temperature (°C)*: ' + (d.temperature || '-'),
        '*Pulse (bpm)*: ' + (d.pulse || '-'),
        '*Respiratory Rate*: ' + (d.respiratoryRate || '-'),
        '*Blood Pressure*: ' + (d.bloodPressure || '-'),
        '*Oxygen Saturation*: ' + (d.oxygenSaturation || '-'),
        '*Blood Sugar*: ' + (d.bloodSugar || '-'),
        '*Pain (0–10)*: ' + (d.pain || '-'),'',
        '*Medication – Morning*: ' + (d.medMorning || '-'),
        '*Medication – Afternoon*: ' + (d.medAfternoon || '-'),
        '*Medication – Evening*: ' + (d.medEvening || '-'),'',
        '*Notes*: ' + (d.notes || '-'),
        '*Nurse*: ' + (d.nurseName || '-'),'',
        '— Sent via Victoria Nurse'
      ].join('\\n');
    }

    async function generateNeonPDF(d){
      const node = document.getElementById('formVitals');
      const canvas = await html2canvas(node, { scale: 2, backgroundColor: '#ffffff' });
      const imgData = canvas.toDataURL('image/png');
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('p','pt','a4');
      pdf.addImage(imgData,'PNG',20,20,555,770);
      pdf.save(`Victoria_Nurse_${d.patientName || 'patient'}.pdf`);
    }

    function clearAll(){ ids.forEach(k => { if(g(k)) g(k).value = ''; }); }

    document.getElementById('btnPreview').addEventListener('click', async ()=>{
      const d = getData(); await generateNeonPDF(d); clearAll();
    });
    document.getElementById('btnWhatsApp').addEventListener('click', ()=>{
      const d = getData(); window.open(`https://wa.me/?text=${encodeURIComponent(formatWhatsApp(d))}`,'_blank'); clearAll();
    });
    document.getElementById('btnEmail').addEventListener('click', async ()=>{
      const d = getData(); await generateNeonPDF(d);
      const subject = `Patient Vitals — ${d.patientName || 'Unnamed'}`;
      const body = formatWhatsApp(d).replace(/\*/g,'');
      window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      clearAll();
    });

    // Register SW
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register(`./service-worker.js?v=${window.__VN_VER__}`, { scope: './' });
      });
    }
  </script>
</body>
</html>
