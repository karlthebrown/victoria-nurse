<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Victoria Nurse — Care Together</title>

  <!-- VERSION -->
  <script>window.__VN_VER__ = "2025-09-17-19";</script>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest?v=2025-09-12-11"/>
  <meta name="theme-color" content="#6366f1"/>

  <!-- Icons -->
  <link rel="icon" type="image/png" href="./icons/favicon.png?v=2025-09-12-11"/>
  <link rel="apple-touch-icon" href="./icons/icon-192.png?v=2025-09-12-11"/>

  <!-- Fonts & Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- PDF libs -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <style>
    :root{
      --vn-purple:#6A0DAD;
      --vn-pink:#FF61A6;
      --vn-blue:#7DDFFF;
    }

    label { color: var(--vn-blue); }

    .vn-field{
      color: var(--vn-blue);
      padding: 0.95rem 1.1rem;
      border-radius: 0.9rem;
      border: 1px solid #cbd5e1;
      background: #ffffff;
    }
    .vn-field:focus{
      outline: none;
      box-shadow: 0 0 0 2px var(--vn-blue);
      border-color: var(--vn-blue);
    }
    .vn-field::placeholder{ color:#9fb6c8; opacity:.85; }
    .vn-input{ height:3.5rem; }
    .vn-textarea{ min-height:3.5rem; }

    .vn-tagline{ font-family:"Playfair Display", serif; }

    .btn-grad{
      background-image: linear-gradient(90deg, var(--vn-purple), var(--vn-pink), var(--vn-blue));
      color:#fff; font-weight:600; padding:.95rem 1.2rem; border-radius:1.1rem;
      transition: transform .12s ease, opacity .12s ease; box-shadow:0 14px 35px rgba(0,0,0,.25);
    }
    .btn-grad:hover{ opacity:.97; transform: translateY(-1px); }
    .btn-grad:active{ transform: translateY(0) scale(.98); }

    /* PDF overlay values */
    .pdf-val{ position:absolute; font-weight:900; color:#fff;
      text-shadow:0 2px 6px rgba(0,0,0,.55); font-size:32px; }
    .v-hr   { top:13%; left:78%; }
    .v-bp   { top:33%; left:78%; }
    .v-spo2 { top:53%; left:78%; }
    .v-rr   { top:73%; left:78%; }
    .v-temp { top:91%; left:78%; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-700 via-pink-500 to-sky-400 text-slate-900 antialiased">
  <div class="min-h-screen p-4 flex items-center justify-center">
    <main class="w-full max-w-3xl">
      <div class="bg-white/85 backdrop-blur-xl shadow-2xl rounded-3xl overflow-hidden ring-1 ring-white/40">

        <!-- Header -->
        <header class="bg-gradient-to-r from-purple-700 via-pink-500 to-sky-400 p-6">
          <div class="flex items-center gap-4">
            <img src="./icons/icon-192.png?v=2025-09-12-11" alt="Victoria Nurse logo"
                 class="h-14 w-14 rounded-2xl shadow">
            <div>
              <h1 class="text-white text-2xl font-extrabold tracking-tight">Victoria Nurse</h1>
              <p class="vn-tagline text-white/95 text-sm">Care Together</p>
            </div>
          </div>
        </header>

        <!-- Form -->
        <section class="p-6 grid gap-6">
          <form id="formVitals" class="grid gap-6" autocomplete="off">
            <!-- Patient + vitals inputs -->
            <!-- (keep same structure as before — omitted here for brevity) -->
          </form>

          <!-- Actions -->
          <div class="flex flex-col sm:flex-row gap-3 mt-4">
            <button id="btnPreview" type="button" class="btn-grad flex-1">Preview & Generate PDF</button>
            <button id="btnWhatsApp" type="button" class="btn-grad flex-1">Share via WhatsApp</button>
            <button id="btnEmail" type="button" class="btn-grad flex-1">Share via Email (PDF)</button>
          </div>
        </section>

        <!-- Footer -->
        <footer class="px-6 py-4 bg-white/70 text-sm flex items-center justify-between">
          <span class="font-medium" style="color:#6A0DAD">&copy; <span id="year"></span> Victoria Nurse</span>
          <span class="italic" style="color:#6A0DAD">Powered by: karlthebrown</span>
        </footer>
      </div>
    </main>
  </div>

  <!-- PDF Template -->
  <div id="pdfCanvas" class="hidden">
    <div style="position:relative;width:794px;height:1123px;">
      <img src="./images/pdf-vitals-bg.jpg" style="width:100%;height:100%;object-fit:cover"/>
      <div class="pdf-val v-hr"   id="pdfPulseVal">-- bpm</div>
      <div class="pdf-val v-bp"   id="pdfBPVal">-- mmHg</div>
      <div class="pdf-val v-spo2" id="pdfO2Val">-- %</div>
      <div class="pdf-val v-rr"   id="pdfRRVal">-- rpm</div>
      <div class="pdf-val v-temp" id="pdfTempVal">-- °C</div>
    </div>
    <div style="margin-top:10px;font-size:14px;color:#111;">
      <strong>Notes:</strong> <span id="pdfNotes">--</span>
    </div>
    <div style="margin-top:20px;font-size:12px;color:#555;text-align:right;">
      Powered by: karlthebrown
    </div>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    const ids = ['patientName','temperature','pulse','respiratoryRate','bloodPressure','oxygenSaturation','bloodSugar','pain','medMorning','medAfternoon','medEvening','notes','nurseName'];
    const el=id=>document.getElementById(id);

    function getData(){ const d={}; ids.forEach(k=>d[k]=(el(k)?.value||'').trim()); return d; }

    async function generateNeonPDF(d){
      document.getElementById('pdfPulseVal').textContent = (d.pulse||'--')+' bpm';
      document.getElementById('pdfBPVal').textContent    = (d.bloodPressure||'--')+' mmHg';
      document.getElementById('pdfO2Val').textContent    = (d.oxygenSaturation||'--')+' %';
      document.getElementById('pdfRRVal').textContent    = (d.respiratoryRate||'--')+' rpm';
      document.getElementById('pdfTempVal').textContent  = (d.temperature||'--')+' °C';
      document.getElementById('pdfNotes').textContent    = d.notes||'--';

      const node=document.getElementById('pdfCanvas');
      node.style.display='block';
      const canvas=await html2canvas(node,{scale:2,backgroundColor:'#fff'});
      node.style.display='none';

      const imgData=canvas.toDataURL('image/png');
      const { jsPDF }=window.jspdf;
      const pdf=new jsPDF('p','pt','a4');
      const pageWidth=pdf.internal.pageSize.getWidth();
      const imgWidth=pageWidth-40;
      const imgHeight=canvas.height*(imgWidth/canvas.width);
      pdf.addImage(imgData,'PNG',20,20,imgWidth,imgHeight,'','FAST');

      pdf.save(`Victoria_Nurse_${(d.patientName||'patient').replace(/[^\w\-]+/g,'_')}_${new Date().toISOString().slice(0,10)}.pdf`);
    }

    document.getElementById('btnPreview').addEventListener('click',async()=>{await generateNeonPDF(getData());});
    document.getElementById('btnWhatsApp').addEventListener('click',()=>{const d=getData();window.open(`https://wa.me/?text=${encodeURIComponent(JSON.stringify(d,null,2))}`,'_blank');});
    document.getElementById('btnEmail').addEventListener('click',()=>{const d=getData();generateNeonPDF(d);window.location.href=`mailto:?subject=Patient Vitals&body=${encodeURIComponent(JSON.stringify(d,null,2))}`;});
  </script>
</body>
</html>